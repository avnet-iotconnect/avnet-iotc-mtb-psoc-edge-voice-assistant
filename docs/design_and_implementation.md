[Click here](../README.md) to view the README.

## Design and implementation

The design of this application allows you to test models generated by the DEEPCRAFT&trade; Voice Assistant Cloud tool on PSOC&trade; Edge MCU devices. In the *[common.mk](../common.mk)* file, you can set the `DEEPCRAFT_PROJECT_NAME` used in the cloud tool. By default, this code example uses a pre-generated model to detect "OK Infineon" wake word and a few smart light commands. The following table describes the models that comes along with this code example.

DEEPCRAFT&trade; project name | Wake word | List of commands 
-----------------------|-----------|-----------------
Smart_Lights_Demo (default) | OK Infineon | See [Smart lights demo](../proj_cm55/va_models/Smart_Lights_Demo/command_list_Smart_Lights_Demo.txt)
LED_Demo | OK Infineon | See [LED demo](../proj_cm55/va_models/LED_Demo/command_list_LED_Demo.txt)
Cooktop_Demo | Hey Cook Top | See [Cooktop demo](../proj_cm55/va_models/Cooktop_Demo/command_list_Cooktop_Demo.txt)

> **Note:** If you are using the LED demo, it adds additional code to control the kit's green LED state and brightness through the commands detected.

The *[common.mk](../common.mk)* file has also an option (`USE_AUDIO_ENHANCE`) to enable/disable the DEEPCRAFT&trade; Audio Enhancement. By default, this option is enabled and apply the noise suppression algorithm only. You can change the audio-front-end configuration from DEEPCRAFT&trade; audio enhancement by editing the *[audio_enhacement_afe.mtbafe](../proj_cm55/afe/audio_enhancement_afe.mtbafe)*. If your application requires to add Acoustic Echo Cancellation (AEC), refer to the [Audio Enhancement Application code example](https://github.com/Infineon/mtb-example-psoc-edge-ae-application).

The examples comes by default with a 15 minute time limit version of the Audio Enhancement middleware and a 30 minute time limit version of the Voice Assistant middleware. If you obtained the unlimited licensed version, set CONFIG_VOICE_CORE_MODE=FULL in the *[common.mk](../common.mk)* file and place the COMPONENT_AVC_FULL folder inside the *proj_cm55* project.

In the *main.c* file, you can set `#define RUNNING_MODE` to different modes:

- **VA_MODE_WW_SINGLE_CMD:** For every wake word, a single command is detected
- **VA_MODE_WW_MULTI_CMD:** For every wake word, multiple commands can be detected
- **VA_MODE_WW_ONLY:** Only wake word detection is performed
- **VA_MODE_CMD_ONLY:** Only command detection is performed

The main application uses the kit's blue LED to indicate which state the Voice Assistant is running:
- **LED is ON**: waiting for the user to say the wake word
- **LED is breathing**: waiting for the user to say the command

The *main.c* file also has an option to print the MCPS for the voice assistant process function. Just uncomment `#define SHOW_MCPS` in the project. Note that the firmware only prints the MCPS required by the voice assistant process function.

<br>